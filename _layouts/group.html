---
layout: main
css: ../stylesheets/stylesheet.css
---
<h1><a name="h.jkvseqok3de"></a><span>Deploy an application with &ldquo;Elastic Beanstalk&rdquo;</span></h1><p><span></span></p><p><img src="images/image00.png"></p><p><span></span></p><p><span></span></p><p><span><a href="#h.jkvseqok3de">Deploy an application with &ldquo;Elastic Beanstalk&rdquo;</a></span></p><p><span><a href="#h.z9jik6tm9217">Connect to AWS console</a></span></p><p><span><a href="#h.wqqlorlisphh">Create a new sample application</a></span></p><p><span><a href="#h.rb0ok5ub3ik5">Application Details</a></span></p><p><span><a href="#h.ehxc748ma7ut">Environment Details (Option A : create a DB Instance with the environment)</a></span></p><p><span><a href="#h.bamqbngijou">Configuration Details</a></span></p><p><span><a href="#h.e47dwwh7ad9j">*</a></span></p><p><span><a href="#h.v6v5ysgci6qz">Configuration Details (Option A : Create the DB from a snapshot)</a></span></p><p><span><a href="#h.p4oik7rglm9d">Test sample application</a></span></p><p><span><a href="#h.sk9s7lt50pi7">Deploy PetClinic application in place of the sample application</a></span></p><p><span><a href="#h.l1qkrd74dlrp">Upload the Petclinic war file</a></span></p><p><span><a href="#h.zg3zc1e7x3nf">SDK CLI installation</a></span></p><p><span><a href="#h.kcmccid8htd3">Deploy a new application</a></span></p><p><span><a href="#h.cvd5wvt7lkf8">Upload your application version stored in S3 bucket in your Team-application</a></span></p><p><span><a href="#h.uklklhgs2oz8">Check your environment informations</a></span></p><p><span><a href="#h.fwumo0armi5s">Create a template configuration of your first environment named myConfig</a></span></p><p><span><a href="#h.6zcq2h1vfzt1">*</a></span></p><p><span><a href="#h.tndr9wsxfsdr">Now you can create a new environment with your file template configuration</a></span></p><p><span><a href="#h.6uwjb22eferq">Useful command</a></span></p><p><span><a href="#h.w7g95l63tin">Terminate your environment</a></span></p><p><span><a href="#h.c11y3td4qqi">Delete your environment</a></span></p><p><span><a href="#h.ctddoeui2bjm">Delete your application</a></span></p><p><span><a href="#h.map0mpz4dp22">Part 3 - Blue/Green Deployment</a></span></p><p><span><a href="#h.a95rdu26denp">Saving your PRD environment configuration settings</a></span></p><p><span><a href="#h.yg784ymilwry">Upload the new application version</a></span></p><p><span><a href="#h.9vs3tfaz8kwa">Create a new QA environment</a></span></p><p><span><a href="#h.b3fpwc2c9p72">Deploy the new application version with Zero Downtime</a></span></p><p><span></span></p><p><span></span></p><p><span></span></p><p><span></span></p><p><span>Prerequisites: AWS command line tools (</span><span><a href="http://www.google.com/url?q=http%3A%2F%2Fdocs.amazonwebservices.com%2Felasticbeanstalk%2Flatest%2Fdg%2FusingCLI.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHAC166mLlXA1Ezxv5Xz_OctjR-BQ">Help here</a></span><span>) </span></p><hr style="page-break-before:always;display:none;"><p><span></span></p><h2><a name="h.z9jik6tm9217"></a><span>Connect to AWS console</span></h2><p><span>The AWS console is here: </span><span><a href="https://xebia-france.signin.aws.amazon.com/console">https://xebia-france.signin.aws.amazon.com/console</a></span></p><p><span></span></p><p><span>The login and password are the one provided on the workshop sheet on the table.</span></p><h2><a name="h.wqqlorlisphh"></a><span>Create a new sample application</span></h2><p><span>When logged, you arrive on AWS Management Console home page and click on &ldquo;Elastic Beanstalk&rdquo; :</span></p><p><img src="images/image10.png"></p><p><span></span></p><p><span>Then once in the Elastic Beanstalk console you must change your region to EU (Ireland) :</span></p><p><span></span></p><p><img src="images/image27.png"></p><h3><a name="h.rb0ok5ub3ik5"></a><span>Application Details</span></h3><p><span></span></p><p><span>Create a new application by following the next steps:</span></p><p><span></span></p><p><span>Click on &ldquo;Create New Application&rdquo;.</span></p><p><span>Then in the modal window provide the &ldquo;Application-Name&rdquo; type &lsquo;petclinic-{{ page.groupId }}&rsquo;</span></p><p><span>Select &ldquo;Container Type&rdquo; : &ldquo;64bit Amazon Linux running Tomcat 7&rdquo;</span></p><p><span>Select &ldquo;Application Source&rdquo; : &ldquo;Use the Sample Application&rdquo;.</span></p><p><span>Click on &ldquo;Continue&rdquo;</span></p><p><img src="images/image16.png"></p><hr style="page-break-before:always;display:none;"><p><span></span></p><h3><a name="h.ehxc748ma7ut"></a><span>Environment Details (Option A : create a DB Instance with the environment)</span></h3><p><span>Check &nbsp;&ldquo;Launch a new environment running this application&rdquo; and &ldquo;Create an RDS DB Instance with this environment&rdquo;.</span></p><p><span>Provide the &ldquo;Environment Name&rdquo; : petclinic-{{ page.groupId }}-DEV</span></p><p><span>Provide an environment url (this will be your application url) and check availability</span></p><p><span></span></p><p><img src="images/image32.png"></p><p><span></span></p><hr style="page-break-before:always;display:none;"><p><span></span></p><h3><a name="h.bamqbngijou"></a><span>Configuration Details</span></h3><p><span></span></p><p><span>Choose t1.micro</span></p><p><span>Enter the key pair id of your account (written on your worksheet) TODO : Does it work?</span></p><p><span>Enter &ldquo;/&rdquo; as application health check URL</span></p><h3><a name="h.e47dwwh7ad9j"></a><img src="images/image24.png"></h3><h3><a name="h.v6v5ysgci6qz"></a><span>Configuration Details (Option A : Create the DB from a snapshot)</span></h3><p><span></span></p><p><span>Choose the petclinic snapshot (with the petclinic schema already created)</span></p><p><span>Enter the username root and the password rootroot</span></p><p><img src="images/image28.png"></p><p><span></span></p><p><img src="images/image30.png"></p><p><span></span></p><p><span></span></p><p><img src="images/image11.png"></p><p><span></span></p><p><img src="images/image22.png"></p><p><span></span></p><hr style="page-break-before:always;display:none;"><p><span></span></p><h3><a name="h.p4oik7rglm9d"></a><span>Test sample application</span></h3><p><span>Once the Beanstalk test application environment is up (it may take about 15 minutes) then you should have the following screen</span></p><p><img src="images/image06.png"></p><p><span>Click on the &ldquo;View Running Version&rdquo; to see your first application deployed on Beanstalk:</span></p><p><img src="images/image17.png"></p><p><span></span></p><p><span></span></p><h2><a name="h.sk9s7lt50pi7"></a><span>Deploy PetClinic application in place of the sample application</span></h2><h3><a name="h.l1qkrd74dlrp"></a><span>Upload the Petclinic war file</span></h3><p><img src="images/image12.png"></p><p><span></span></p><p><span>Testing the PetClinic application</span></p><p><span></span></p><p><img src="images/image19.png"></p><p><span></span></p><hr style="page-break-before:always;display:none;"><p><span></span></p><h1><a name="h.zg3zc1e7x3nf"></a><span>SDK CLI installation</span></h1><p><span>Download AWS command line tools (</span><span><a href="http://docs.amazonwebservices.com/elasticbeanstalk/latest/dg/usingCLI.html">Help here</a></span><span>) </span></p><p><span></span></p><p><span>If you have any error with JSON during command execution, execute</span></p><p><span></span></p><a href="#" name="6820246b598c148fd7634922a5578b76730d0abe"></a><a href="#" name="0"></a><table cellpadding="0" cellspacing="0"><tbody><tr><td><p><span>$sudo gem install json</span></p></td></tr></tbody></table><p><span></span></p><hr style="page-break-before:always;display:none;"><p><span></span></p><h1><a name="h.kcmccid8htd3"></a><span>Deploy a new application</span></h1><h3><a name="h.cvd5wvt7lkf8"></a><span>Upload your application version stored in S3 bucket in your Team-application</span></h3><a href="#" name="f4a99b172ca0afe2c8c1029b4efec830719724c4"></a><a href="#" name="1"></a><table cellpadding="0" cellspacing="0"><tbody><tr><td><p><span>$ elastic-beanstalk-create-application-version -a petclinic-{{page.groupId}} -l &#39;petclinic-{{page.groupId}}-1.0&#39; -d &#39;Petclinic application production&#39; -s workshop-aws-beanstalk/V1/petclinic.war</span></p></td></tr></tbody></table><p><span></span></p><p><img src="images/image23.png"></p><p><span></span></p><h3><a name="h.uklklhgs2oz8"></a><span>Check your environment informations</span></h3><a href="#" name="176ed9e280998282bf392dbbca22359ef5f8b7f0"></a><a href="#" name="2"></a><table cellpadding="0" cellspacing="0"><tbody><tr><td><p><span>$ elastic-beanstalk-describe-environments -a petclinic-{{page.groupId}}</span></p></td></tr></tbody></table><p><span>You need to retrieve your environment id.</span></p><p><span></span></p><p><img src="images/image15.png"></p><h3><a name="h.fwumo0armi5s"></a><span>Create a template configuration of your first environment named myConfig</span></h3><a href="#" name="e30aee449366aea628ef8b9d22ad1bcaebc95109"></a><a href="#" name="3"></a><table cellpadding="0" cellspacing="0"><tbody><tr><td><p><span>$ elastic-beanstalk-create-configuration-template -a petclinic-{{page.groupId}} -t petclinic-{{page.groupId}}-config -E [environmentId]</span></p></td></tr></tbody></table><h3><a name="h.6zcq2h1vfzt1"></a><img src="images/image26.png"></h3><h3><a name="h.tndr9wsxfsdr"></a><span>Now you can create a new environment with your file template configuration</span></h3><a href="#" name="3e9f6330dad5d806cbfb07771f978570ecfb62df"></a><a href="#" name="4"></a><table cellpadding="0" cellspacing="0"><tbody><tr><td><p><span>$ elastic-beanstalk-create-environment -a petclinic-{{page.groupId}} -l &#39;petclinic-{{page.groupId}}-1.0&#39; -d &#39;Petclinic application prod&#39; -e petclinic-{{page.groupId}}-prod -t petclinic-{{page.groupId}}-config</span></p></td></tr></tbody></table><p><span></span></p><h3><a name="h.ai2bzs5qfuvm"></a><img src="images/image02.png"></h3><p><span></span></p><p><span>You have now two configured environments:</span></p><p><img src="images/image05.png"></p><h3><a name="h.b9xkb0y0tkvg"></a></h3><h3><a name="h.6uwjb22eferq"></a><span>Useful command</span></h3><a href="#" name="834f036fcb0def9ffe8ad573c31853455665d1ff"></a><a href="#" name="5"></a><table cellpadding="0" cellspacing="0"><tbody><tr><td><p><span>$ elastic-beanstalk-describe-environments -a GEG-WorkshopApplication</span></p></td></tr></tbody></table><h3><a name="h.s81qrfacrpj9"></a></h3><a href="#" name="c79d0f30e35aa5634d3731d51cf73e07571c802a"></a><a href="#" name="6"></a><table cellpadding="0" cellspacing="0"><tbody><tr><td><p><span>$ elastic-beanstalk-delete-environment-configuration -a GEG-WorkshopApplication -e UAT-environment</span></p></td></tr></tbody></table><h3><a name="h.5yvefjw3wqem"></a></h3><a href="#" name="71a6ab8cee2392b09c09b14a22b579121e83aeae"></a><a href="#" name="7"></a><table cellpadding="0" cellspacing="0"><tbody><tr><td><p><span>$ elastic-beanstalk-terminate-environment -e UAT-environment</span></p></td></tr></tbody></table><p><span></span></p><h3><a name="h.w7g95l63tin"></a><span>Terminate your environment</span></h3><a href="#" name="71a6ab8cee2392b09c09b14a22b579121e83aeae"></a><a href="#" name="8"></a><table cellpadding="0" cellspacing="0"><tbody><tr><td><p><span>$ elastic-beanstalk-terminate-environment -e UAT-environment</span></p></td></tr></tbody></table><p><span></span></p><h3><a name="h.c11y3td4qqi"></a><span>Delete your environment</span></h3><a href="#" name="c79d0f30e35aa5634d3731d51cf73e07571c802a"></a><a href="#" name="9"></a><table cellpadding="0" cellspacing="0"><tbody><tr><td><p><span>$ elastic-beanstalk-delete-environment-configuration -a GEG-WorkshopApplication -e UAT-environment</span></p></td></tr></tbody></table><p><span></span></p><h3><a name="h.ctddoeui2bjm"></a><span>Delete your application</span></h3><a href="#" name="d3b1b052ebb1714dde9911861eccbc77c11692c3"></a><a href="#" name="10"></a><table cellpadding="0" cellspacing="0"><tbody><tr><td><p><span>$ elastic-beanstalk-delete-application -a GEG-WorkshopApplication</span></p></td></tr></tbody></table><p><span></span></p><p><span></span></p><p><span></span></p><p><span></span></p><p><span></span></p><p><span></span></p><p><span></span></p><p><span></span></p><p><span></span></p><p><span></span></p><p><span></span></p><p><span></span></p><p><span></span></p><p><span></span></p><p><span></span></p><p><span></span></p><p><span></span></p><p><span></span></p><p><span></span></p><p><span></span></p><p><span></span></p><p><span></span></p><p><span></span></p><p><span></span></p><p><span></span></p><h1><a name="h.map0mpz4dp22"></a><span>Part 3 - </span><span>Blue/Green Deployment</span></h1><p><span>One of the challenges with automating deployment is the cut-over itself, taking software from the final stage of testing to live production. You usually need to do this quickly in order to minimize downtime.</span></p><p><span></span></p><p><img src="images/image07.png"></p><p><span>The blue-green deployment approach does this by ensuring you have two production environments, as identical as possible. At any time one of them, let&#39;s say blue for the example, is live. As you prepare a new release of your software you do your final stage of testing in the green environment. Once the software is working in the green environment, you switch the router so that all incoming requests go to the green environment - the blue one is now idle.</span></p><h2><a name="h.a95rdu26denp"></a><span>Saving your PRD environment configuration settings</span></h2><p><img src="images/image18.png"></p><p><span></span></p><p><span>Below the application selection drop-down list, click the </span><span>Actions</span><span>&nbsp;drop-down list for your application environment in the application&#39;s Environments list and select </span><span>Save Configuration</span><span>.</span></p><p><span></span></p><p><img src="images/image33.png"></p><p><span></span></p><p><span>In the </span><span>Configuration Name</span><span>&nbsp;field type </span><span>petclinic-configuration-{{page.groupId}}</span><span>&nbsp;and click </span><span>Save Config</span><span>.</span></p><p><span></span></p><p><img src="images/image21.png"></p><h2><a name="h.yg784ymilwry"></a><span>Upload the new application version</span></h2><p><span>Go to the </span><span>Versions</span><span>&nbsp;tab, and click </span><span>Upload New Version</span><span>. In the pop-up windows, indicate </span><span>petclinic-{{page.groupId}}-2.0 </span><span>in the </span><span>Version Label</span><span>&nbsp;field and upload the new version of your application.</span></p><p><span></span></p><p><span>Do not forget to check the deployment option </span><span>Upload but do not deploy to any environment</span><span>, and then click </span><span>Upload New Version</span><span>.</span></p><p><span></span></p><p><img src="images/image13.png"></p><p><span></span></p><p><span>Now, verify that your new application version has been correctly uploaded.</span></p><p><span></span></p><p><img src="images/image25.png"></p><h2><a name="h.9vs3tfaz8kwa"></a><span>Create a new QA environment</span></h2><p><span>Click </span><span>Launch New Environment</span><span>&nbsp;button and fill the form with </span><span>petclinic-{{page.groupId}}-qa</span><span>&nbsp;as environment name. Indicate that you want to use an existing application version and select </span><span>Second Release.</span></p><p><span></span></p><p><span>In the Container Type, indicate </span><span>64bit Amazon Linux running Tomcat 7</span><span>&nbsp;and check the </span><span>Create an RDS DB Instance with this environment</span><span>&nbsp;option.</span></p><p><span></span></p><p><span>Then click </span><span>Continue.</span></p><p><span></span></p><p><img src="images/image03.png"></p><p><span></span></p><p><span>On the next step, indicate that you want to </span><span>Load a Saved Configuration</span><span>&nbsp;by selecting the </span><span>petclinic-configuration-{{page.groupId}}</span><span>&nbsp;configuration, and click </span><span>Continue</span><span>.</span></p><p><span></span></p><p><img src="images/image29.png"></p><p><span></span></p><p><span>Concerning the </span><span>RDS DB Instance</span><span>, indicate that you want to create it from a snaphot and select </span><span>petclinic-database-created-snapshot</span><span>.</span></p><p><span></span></p><p><span>Fill </span><span>rootroot</span><span>&nbsp;as master password, and click </span><span>Continue</span><span>.</span></p><p><span></span></p><p><img src="images/image09.png"></p><p><span></span></p><p><span>Verify your environment information and click </span><span>Finish</span><span>.</span></p><p><span></span></p><p><img src="images/image14.png"></p><h2><a name="h.b3fpwc2c9p72"></a><span>Deploy the new application version with Zero Downtime</span></h2><p><span>Now, you have 2 environments:</span></p><ol start="1"><li><span>QA (Blue Slice)</span></li><li><span>PRD (Green Slice)</span></li></ol><p><span></span></p><p><span>Make sure that your new environment is in the Green and Ready state.</span></p><p><span></span></p><p><img src="images/image31.png"></p><p><span></span></p><p><span>Click the </span><span>Actions</span><span>&nbsp;drop-down list on your live production application environment and select </span><span>Swap Environment URL</span><span>.</span></p><p><span></span></p><p><img src="images/image01.png"></p><p><span></span></p><p><span>In the </span><span>Swap Environment URL</span><span>&nbsp;window, select </span><span>petclinic-{{page.groupId}}-qa</span><span>&nbsp;from the </span><span>Environment Name</span><span>&nbsp;pull-down menu, and then click on </span><span>Swap URL</span><span>.</span></p><p><span></span></p><p><img src="images/image04.png"></p><p><span></span></p><p><span>Now the new release version of your application is accessible through the URL of your live production environment: </span><span>http://petclinic-{{page.groupId}}.elasticbeanstalk.com/</span><span>.</span></p><p><span></span></p><p><img src="images/image20.png"></p><p><span></span></p><p><span>Enjoy!</span></p><p><span></span></p><p><img src="images/image08.png"></p>